# 408 计算机网络 #

1.1 信息时代的计算机网络
1.2因特网概述
1.3电路交换、分组交换和报文交换
1.4计算机网络的定义和分类
1.5计算机网络的性能指标
1.6计算机网络的体系结构
1.7我国的计算机网络发展情况

internet:互联网（互连网），通用名词，任意通信协议

Internet:因特网，专用名词，TCP/IP协议族

因特网发展的三个阶段：

| 1969                                                      | 1985                                   | 1993                                     |
| --------------------------------------------------------- | -------------------------------------- | ---------------------------------------- |
| ARPANET向互连网发展                                       | 三级结构因特网                         | 多层次ISP结构的因特网                    |
| 1969年，第一个分组交换网ARPANET                           | 1985年，NSFNET(主干网、地区网和校园网) | 1993年，NSFNET被替代，由各种ISP运营      |
| 70年代中期，研究多种网络的互连                            | 1990年，ARPANET任务完成，正式关闭      | 1994年，WWW技术推动因特网迅速发展        |
| 1983年，TCP/IP协议成为ARPANET的标准协议（因特网诞生时间） | 1991年，因特网初步商业化，开始收费     | 1995年，NSFNET停止运作，因特网彻底商业化 |

ISP：Internet Service Provider, 中国为电信、移动、联通，各用户通过ISP接入因特网。

因特网的标准化工作
因特网的标准化工作是面向公众的，其任何一个建议标准在成为因特网标准之前都以RFC技术文档的形式在因特网上发表。
RFC(Request For Comments)的意思是“请求评论”。任何人都可以从因特网上免费下载RFC文档(http:www.ietf.org/rfc.html)，并随时对某个RFC文档发表意见和建议。

电路交换：

报文交换：

分组交换：

| 电路交换                                                     | 报文交换                                                     | 分组交换                                                     |
| ------------------------------------------------------------ | ------------------------------------------------------------ | :----------------------------------------------------------- |
| （1）建立连接：分配通信资源 <br/>（2） 通话：一直占用通信资源<br/>（3）释放连接：归还通信资源。 |                                                              | 报文交换是分组交换的前身。<br/>在报文交换中，报文被整个地发送，而不是拆分成若干个分组进行发送。交换节点将报文整体接收完成后才能查找转发表，将整个报文转发到下一个节点。 |
|                                                              | 没有建立连接和释放连接的过程。<br/>分组传输过程中逐段占用通信链路有较高的通信线路利用率。<br/>交换节点可以为每一个分组独立选择转发路由，使得网络有很好的生存性 |                                                              |
| 计算机之间的数据传送是突发式的，当使用电路交换来传送计算机数据时，其线路的传输效率一般都会很低，线路上真正用来传送数据的时间往往不到10%甚至1%。 | 分组首部带来了额外的传输开销。<br/>交换节点存储转发分组会造成一定的时延。<br/>无法确保通信时端到端通信资源全部可用，在通信量较大时可能造成网络拥塞。分组可能会出现失序和丢失等问题。 | 报文交换比分组交换带来的转发时延要长很多需要交换节点具有的缓存空间也大很多 |

三种交换方式的对比
若要连续传送大量的数据，并且数据传送时间远大于建立连接的时间，则使用电路交换可以有较高的传输效率。然而计算机的数据传送往往是突发式的，采用电路交换时通信线路的利用率会很低。<br/>报文交换和分组交换都不需要建立连接(即预先分配通信资源)，在传送计算机的突发数据时可以提高通信线路的利用率。<br/>
将报文构造成若干个更小的分组进行分组交换，比将整个报文进行报文交换的时延要小，并且还可以避免太长的报文长时间占用链路，有利于差错控制，同时具有更好的灵活性。


计算机网络早期的一个最简单定义：互连、自治（每台计算机都有独立的软件和硬件，并且可以单独运行）、计算机集合。

计算机网络的分类

| 交换方式                     | 使用者                                           | 传输介质           | 覆盖范围                                                     | 拓扑结构                     |
| ---------------------------- | ------------------------------------------------ | ------------------ | ------------------------------------------------------------ | ---------------------------- |
| 电路交换、报文交换、分组交换 | 公用网（因特网）、专用网(军队、铁路、电力、银行) | 有线网络、无线网络 | 广域网(WAN)几十到几干干米、城域网(MAN)5到50干米、局域网(LAN)1千米左右、个域网(PAN)10米 | 总线型、星型、环型、网状型。 |



***



计算机网络的性能指标：
计算机网络的性能指标被用来从不同方面度量计算机网络的性能。

常用的八个计算机网络性能指标

| 速率                                                         | 带宽                                                         | 吞吐量                                                       | 时延                                                         | 时延带宽积                                                   | 往返时间                                                     | 利用率 | 丢包率                                                       |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------ | ------------------------------------------------------------ |
| 数据的传送速率(即每秒传送多少个比特) 可简记为b/s，也称为数据率、比特率 | 用来表示网络的通信线路所能传送数据的能力，即在单位时间内从网络中的某一点到另一点所能通过的最高速率。<br/>数据传送速率=min[主机接口速率，线路带宽，交换机或路由器的接口速率] | 吞吐量是指在单位时间内通过某个网络或接口的实际数据量。吞吐量常被用于对实际网络的测量以便获知到底有多少数据量通过了网络。<br/>吞吐量受网络带宽的限制。 | 时延是指数据从网络的一端传送到另一端所耗费的时间，也称为延迟或迟延。数据可由一个或多个分组、甚至是一个比特构成。 | 时延带宽积是传播时延和带宽的乘积。<br/>链路的时延带宽积也称为以比特为单位的链路长度，这对我们以后理解以太网的最短帧长是非常有帮助的。 | 往返时间(Round-Trip Time，RTT)是指从发送端发送数据分组开始，到发送端收到接收端发来的相应确认分组为止，总共耗费的时间。 |        | 丢包率是指在一定的时间范围内，传输过程中丢失的分组数量与总分组数量的比率 |
|                                                              |                                                              |                                                              |                                                              |                                                              |                                                              |        |                                                              |

| 速率的单位      | 换算关系                            | 数据量的单位 | 换算关系                  |
| --------------- | ----------------------------------- | ------------ | ------------------------- |
| 比特/秒(b/s)    | 基本单位                            | 比特(b)      | 基本单位                  |
|                 |                                     | 字节(B)      | 1B = 8bit                 |
| 千比特/秒(kb/s) | kb/s =10<sup>3</sup> b/s            | 干字节(KB)   | KB=2<sup>10</sup>B        |
| 兆比特/秒(Mbs)  | Mb/s = k*kb/s = 10<sup>6</sup> b/s  | 兆字节(MB)   | MB =K*KB=2<sup>20</sup>B  |
| 吉比特/秒(Gb/s) | Gb/s= k*Mb/s = 10<sup>9</sup> b/s   | 吉字节(GB)   | GB=K*MB = 2<sup>30</sup>B |
| 太比特/秒(Tb/s) | Tb/s = k*Gb/s = 10<sup>12</sup> b/s | 太字节(TB)   | TB=K*GB=2<sup>40</sup>B   |

```plaintext
发送时延=分组长度(b)/发送速率（b/s）
```

```plaintext
传播时延=信号长度(m)/信号传播速率（m/s）
```

排队时延和处理时延不方便计算

```plaintext
发送速率=min[主机接口速率，线路带宽，交换机或路由器的接口速率]
```

| 链路利用率                                                   | 网络利用率                                           |
| ------------------------------------------------------------ | ---------------------------------------------------- |
| 链路利用率是指某条链路有百分之几的时间是被利用的(即有数据通过)<br/>完全空闲的链路的利用率为零 | 网络利用率是指网络中所有链路的链路利用率的加权平均。 |

根据排队论可知，当某链路的利用率增大时，该链路引起的时延就会迅速增加。

当网络的通信量较少时，产生的时延并不大，但在网络通信量不断增大时，分组在交换节点(路由器或交换机)中的排队时延会随之增大，因此网络引起的时延就会增大。

令D<sub>0</sub>表示网络空闲时的时延，D表示网络当前的时延，那么在理想的假定条件下，可用下式来表示D、D<sub>0</sub>和网络利用率U之间的关系。

```plaintext
D(网络当前时延) = D0(网络空闲时的时延) / (1 - U)
```

分组丢失主要有以下两种情况:

1. 分组在传输过程中出现误码，被传输路径中的节点交换机(例如路由器)或目的主机检测出误码而丢弃。
2. 节点交换机根据丢弃策略主动丢弃分组.

丢包率可以反映网络的拥塞情况:

1. 无拥塞时路径丢包率为0。
2. 轻度拥塞时路径丢包率为1%~4%。
3. 严重拥塞时路径丢包率为5%~15%。


常见的三种计算机网络体系解构：

1. | OSI                                                          | TCP/IP     | 1    |
   | ------------------------------------------------------------ | ---------- | ---- |
   | 应用层                                                       | 应用层     |      |
   | 表示层                                                       | 运输层     |      |
   | 会话层                                                       | 网际层     |      |
   | 运输层                                                       | 网络接口层 |      |
   | 网络层                                                       |            |      |
   | 数据链路层                                                   |            |      |
   | 物理层                                                       |            |      |
   | OSI标准失败的原因<br/>专家没有实际经验完成标准时没有商业驱动力<br/>协议实现过分复杂运行效率很低<br/>标准的制定周期太长产品无法及时进入市场<br/>层次划分不太合理有些功能在多个层次中重复出现 |            |      |

误码的相关概念
实际的通信链路都不是理想的，比特在传输过程中可能会产生差错(称为比特差错)
比特1可能变成比特0
比特0可能变成比特1
在一段时间内，传输错误的比特数量占所传输比特总数的比率称为误码率(Bit Error Rate，BER)提高链路的信噪比，可以降低误码率。但在实际的通信链路上，不可能使误码率下降为零。

使用差错检测技术来检测数据在传输过程中是否产生了比特差错，是数据链路层所要解决的重要问题之一。

![image-20241122104803223](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241122104803223.png)

检错码成为FCS

奇校验是在待发送的数据后面添加1个校验位，使得添加该校验位后的整个数据中比特1的个数为奇数。
偶校验是在待发送的数据后面添加1个校验位，使得添加该校验位后的整个数据中比特1的个数为偶数。

在所传输的数据中，如果有奇数个位发生误码，则所包含比特1的数量的奇偶性会发生改变，可以检测出误码。
在所传输的数据中，如果有偶数个位发生误码，则所包含比特1的数量的奇偶性不会发生改变，无法检测出误码(漏检)
在实际使用时，奇偶校验又可分为垂直奇偶校验、水平奇偶校验以及水平垂直奇偶校验。

![image-20241122104931244](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241122104931244.png)

![image-20241122104941115](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241122104941115.png)

循环冗余校验
数据链路层广泛使用漏检率极低的循环冗余校验:(Cyclic Redundancy Check，CRC)检错技术
循环冗余校验CRC的基本思想:
**收发双方约定好一个生成多项式G(X)。**

**发送方基于待发送的数据和生成多项式G(X)，计算出差错检测码(冗余码)**

**将冗余码添加到待发送数据的后面一起传输。**

**接收方收到数据和冗余码后，通过生成多项式G(X)来计算收到的数据和冗余码是否产生了误码。**

![image-20241122105120411](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241122105120411.png)

![image-20241122105140120](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241122105140120.png)

 ![image-20241122110749424](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241122110749424.png)

算法要求生成多项式必须包含最低次项即x的0次项 。



**发送方的处理：**

![image-20241122111312305](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241122111312305.png)

生成多项式为G(X)=1乘以X^3+1乘以X^2+0乘以X^1+1乘以X^0

![image-20241122111959319](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241122111959319.png)

1为够除即被除数和除数位数相同都为4位。

最后一行的1位余数。



**接收方的处理**

![image-20241122112453300](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241122112453300.png)

![image-20241122112838801](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241122112838801.png)

写错了，接收方构建被除数时不要将生成多项式的系数添加到后面。

![image-20241122113124834](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20241122113124834.png)

>奇偶校验、循环冗余校验等差错检测技术，只能检测出传输过程中出现了差错，但并不能定位错误因此无法纠正错误。
>
>要想纠正传输中的差错，可以使用冗余信息更多的纠错码(例如海明码)进行前向纠错。但纠错码的开销比较大，在计算机网络中较少使用。
>
>在计算机网络中，通常采用我们后续课程中将要介绍的检错重传方式来纠正传输中的差错，或者仅仅丢弃检测到差错的帧，这取决于数据链路层向其上层提供的是可靠传输服务还是不可靠传输服务。
>
>循环冗余校验CRC具有很好的检错能力(漏检率极低)，虽然计算比较复杂，但非常易于用硬件实现因此被广泛应用于数据链路层。



#### 可靠传输

使用差错检测技术(例如循环冗余校验CRC)，接收方的数据链路层就可检测出帧在传输过程中是否产生了误码(比特差错)。

检测出误码了怎么做呢？

这取决于数据链路层向其上层提供的服务类型。

若为不可靠传输服务:仅仅丢弃有误码的帧，其他什么也不做，
若为可靠传输服务:通过某种机制实现发送方发送什么，接收方最终就能收到什么。（例如：接收方检测到了误码并向发送方发送一个否认帧，发送方收到否认帧后。重新发送）。

一般情况下，有线链路的误码率比较低。为了减小开销，并不要求数据链路层向其上层提供可靠传输服务。即使出现了误码，可靠传输的问题由其上层处理。

无线链路易受干扰误码率比较高，因此要求数据链路层必须向其上层提供可靠传输服务

传输差错:分组重复、分组失序、分组丢失出现在数据链路层的上层。误码(比特差错)出现在数据链路层及其下层

误码(比特差错)
分组丢失:当分组到达路由器R2时,由于R2的排队的队列已经满了,现在又来了一个分组,只能将该分组丢弃了.

分组失序:主机1发送3个有顺序的分组,这3个分组选择了不同的路径,由于路径长度和路由器的繁忙程度不同,所以先发的分组可能最后到达主机2

分组重复:发送的分组到达路由器R5,此时由于R5十分繁忙,导致该分组等待的时间很长,主机1发送超时,所以它重新发送了该分组,该分组选择了一条不繁忙的路径到达了主机2,而在R5的分组也到达了主机2.

可靠传输服务并不局限于数据链路层，其他各层均可选择实现可靠传输。

#### 实现可靠传输的三种协议

停止-等待(Stop-and-Wait，SW)协议、协议回退N帧(Go-back-N，GBN)协议、选择重传(Selective Repeat，SR)协议

这三种可靠传输实现机制的基本原理并不仅限于数据链路层，可以应用到其上各层。

3.2.3（2）
